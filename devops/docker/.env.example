# =============================================================================
# Sibyl MCP Server - Environment Configuration Template
# =============================================================================
#
# Copy this file to .env and customize for your deployment:
#   cp .env.example .env
#
# Usage examples:
#   # Development mode (simple, direct access)
#   docker compose --profile dev up
#
#   # Development with observability
#   docker compose --profile dev --profile observability up
#
#   # Production mode (with nginx, full observability)
#   docker compose --profile prod --profile observability up -d
#
# =============================================================================

# =============================================================================
# Build Configuration
# =============================================================================
BUILD_TARGET=runtime  # runtime | development
VERSION=0.1.0
BUILD_DATE=
VCS_REF=main

# =============================================================================
# Server Configuration
# =============================================================================
# Server mode: stdio (for stdio MCP), http (for HTTP MCP), rest (for REST API)
SIBYL_SERVER_MODE=http

# Logging
SIBYL_LOG_LEVEL=INFO  # DEBUG | INFO | WARNING | ERROR
SIBYL_LOG_FILE=/var/log/sibyl/sibyl.log

# Metrics
SIBYL_ENABLE_METRICS=true
SIBYL_METRICS_PORT=9090

# HTTP Server (if using http mode)
SIBYL_ENABLE_HTTP_SERVER=true
MCP_HTTP_HOST=0.0.0.0
MCP_HTTP_PORT=8770

# REST API Server (if using rest mode)
SIBYL_HOST=0.0.0.0
SIBYL_PORT=8000

# External port mappings
SIBYL_MCP_HTTP_PORT=8770  # External port for MCP HTTP
SIBYL_REST_PORT=8000       # External port for REST API

# =============================================================================
# Workspace Configuration
# =============================================================================
# Path to workspace YAML file (inside container: /app/config/workspaces/)
SIBYL_WORKSPACE_FILE=/app/config/workspaces/example_local.yaml

# Optional: Path to local workspace directory (mounted as /workspace in container)
WORKSPACE_PATH=../../../

# =============================================================================
# DuckDB Configuration
# =============================================================================
DUCKDB_MEMORY_LIMIT=2GB
MCP_DUCKDB_PATH=/var/lib/sibyl/state/sibyl_state.duckdb

# =============================================================================
# API Keys (REQUIRED - DO NOT COMMIT THESE VALUES)
# =============================================================================
# Option 1: Set directly (NOT RECOMMENDED for production)
OPENAI_API_KEY=
ANTHROPIC_API_KEY=
GOOGLE_API_KEY=
COHERE_API_KEY=

# Option 2: Use secrets file (RECOMMENDED for production)
# Create file at: devops/docker/.secrets/api_keys.txt
SECRETS_FILE=./.secrets/api_keys.txt

# =============================================================================
# Resource Limits
# =============================================================================
SIBYL_CPU_LIMIT=2.0
SIBYL_CPU_REQUEST=0.5
SIBYL_MEMORY_LIMIT=4G
SIBYL_MEMORY_REQUEST=1G

# =============================================================================
# Nginx Configuration (Production)
# =============================================================================
NGINX_HTTP_PORT=80
NGINX_HTTPS_PORT=443

# =============================================================================
# Observability Stack
# =============================================================================
# Prometheus
PROMETHEUS_PORT=9090

# Grafana
GRAFANA_PORT=3000
GRAFANA_USER=admin
GRAFANA_PASSWORD=admin  # CHANGE THIS IN PRODUCTION!
GRAFANA_ROOT_URL=http://localhost:3000
GRAFANA_PLUGINS=grafana-piechart-panel,grafana-polystat-panel

# Loki
LOKI_PORT=3100

# Jaeger
JAEGER_UI_PORT=16686
JAEGER_COLLECTOR_PORT=14268
JAEGER_OTLP_GRPC_PORT=4317
JAEGER_OTLP_HTTP_PORT=4318

# =============================================================================
# Environment Metadata
# =============================================================================
ENVIRONMENT=development  # development | staging | production
HOSTNAME=sibyl-dev

# =============================================================================
# Docker Compose Profiles
# =============================================================================
# Available profiles:
#   dev            - Development mode (direct access, hot-reload)
#   prod           - Production mode (nginx, hardened security)
#   observability  - Prometheus + Grafana + Loki + Fluent Bit
#   tracing        - Jaeger distributed tracing
#
# Usage examples:
#   # Development (simple)
#   docker compose --profile dev up
#
#   # Development with observability
#   docker compose --profile dev --profile observability up
#
#   # Production with full stack
#   docker compose --profile prod --profile observability --profile tracing up -d
#
# =============================================================================
